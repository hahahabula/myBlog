---
title: "S2.6 GBDT+LR--特征工程模型化的开端"
description: "解释由Facebook提出的GBDT+LR模型"
date: 2025-02-07
categories: 
    - 搜广推
    - 《深度学习推荐系统》
image: images/paste-1.png
---

FFM模型采用了引入特征域的方式增强了模型的特征交叉能力，但无论如何，FFM模型只能做二阶的特征交叉。如果继续提高特征交叉的维度，会不可避免第产生组合爆炸和计算复杂度过高的问题，因此Facebook提出了以下基于`GBDT+LR`组合模型的解决方案。

# GBDT+LR组合模型的结构

GBDT+LR组合模型是由两个独立训练的部分构成，其结构图如下：

![GBDT+LR组合模型的结构图](images/paste-1.png){fig-align="center" width="396"}

构建该模型首先得先构建一个GBDT（梯度提升树）而后在利用LR模型预测点击率。下文首先介绍利用GBDT进行特征交叉。

# GBDT模型

详细的模型介绍见机器学习中的GBDT模型，在`GBDT+LR`模型中，特征交叉的示意图如下图所示：

![GBDT用于特征交叉示意图](images/paste-2.png){fig-align="left" width="326"}

# GBDT+LR模型的意义

1.  GBDT+LR大大推进了特征工程模型化这一重要趋势。在其出现以前，特征工程的两种解决方法是

    a\) 进行人工的或半人工的特征组合和特征筛选（对算法工程师的经验和精力投入要求高）

    b\) 通过改造目标函数，改进模型结构，增加特征交叉湘的方式增强特征组合能力（对模型设计能力要求较高）

2.  GBDT+LR组合模型的提出意味着特征工程可以完全交由一个独立的模型来完成，模型的输入可以是原始的特征向量，不必再特征工程上投入过多的人工筛选和模型设计的精力，实现真正的端到端(End to End)训练

::: callout-note
## 端到端训练

端对端训练依赖于神经网络的反向传播算法，通过计算损失函数的梯度来更新网络的权重和偏置，从而最小化输出与真实值之间的差异。在整个训练过程中，模型被视为一个整体进行优化，而不是将任务分解为多个独立的子任务。即GBDT模型不需要单独训练而是通过预测CTR的损失来进行更新。
:::